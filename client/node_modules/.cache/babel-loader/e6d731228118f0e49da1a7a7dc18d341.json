{"ast":null,"code":"import _regeneratorRuntime from\"/Users/richard/Documents/time-vault/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/richard/Documents/time-vault/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/richard/Documents/time-vault/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/Users/richard/Documents/time-vault/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";var _templateObject,_templateObject2,_templateObject3,_templateObject4;import React,{useEffect,useState}from\"react\";import{useSelector}from\"react-redux\";import styled from\"styled-components\";import{openCapsule}from\"../services/contracthelper\";import{selectAddress}from\"../state/userSlice\";import capsuleOpen from\"../assets/capsule-open-large.png\";import capsuleLocked from\"../assets/capsule-locked-large.png\";import capsuleReady from\"../assets/capsule-ready-large.png\";import Button from\"./Button\";import{getCapsuleUsdValue}from\"../services/oracleService\";import Countdown from\"./Countdown\";import BlockContent from\"./BlockContent\";import{getCanBeOpened}from\"../services/dateHelper\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var StyledCapsuleOverview=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  @media (max-width: 600px) {\\n    margin-bottom: 6rem;\\n  }\\n\"])));var CapsuleImage=styled.img(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  width: 20rem;\\n  margin-bottom: 2rem;\\n\\n  @media (max-width: 600px) {\\n    width: 100%;\\n  }\\n\"])));var Usd=styled.div(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n  font-size: 4rem;\\n  margin-bottom: 2rem;\\n  transform: rotate(0deg);\\n  color: var(--main);\\n\\n  @media (max-width: 600px) {\\n    font-size: 6rem;\\n  }\\n\"])));var ProgressContainer=styled.div(_templateObject4||(_templateObject4=_taggedTemplateLiteral([\"\\n  width: 100%;\\n  height: 6rem;\\n  background-color: var(--primary);\\n\"])));var CapsuleOverview=function CapsuleOverview(props){var address=useSelector(selectAddress);var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),usd=_useState2[0],setUsd=_useState2[1];var canBeOpened=getCanBeOpened(props.capsule);var open=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return openCapsule(props.capsule.id);case 2:props.update();case 3:case\"end\":return _context.stop();}}},_callee);}));return function open(){return _ref.apply(this,arguments);};}();var getUsd=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(_capsule){var usdValue;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return getCapsuleUsdValue(_capsule);case 2:usdValue=_context2.sent;setUsd(\"$\".concat(Number(usdValue).toFixed(0).toLocaleString()));case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function getUsd(_x){return _ref2.apply(this,arguments);};}();useEffect(function(){getUsd(props.capsule);},[props.capsule]);return/*#__PURE__*/_jsx(StyledCapsuleOverview,{children:/*#__PURE__*/_jsx(BlockContent,{content:/*#__PURE__*/_jsxs(_Fragment,{children:[usd&&usd!==\"$0\"&&/*#__PURE__*/_jsx(Usd,{children:usd}),/*#__PURE__*/_jsx(CapsuleImage,{src:props.capsule.empty?capsuleOpen:!canBeOpened?capsuleLocked:capsuleReady,alt:props.capsule.empty?\"Capsule Empty Image\":!canBeOpened?\"Capsule Locked Image\":\"Capsule Ready Image\"}),/*#__PURE__*/_jsx(Countdown,{capsule:props.capsule}),false&&/*#__PURE__*/_jsx(ProgressContainer,{children:\"meow\"}),props.capsule.beneficiary===address&&canBeOpened&&!props.capsule.empty&&/*#__PURE__*/_jsx(Button,{primary:true,text:\"Open\",click:function click(){return open();}})]})})});};export default CapsuleOverview;","map":{"version":3,"sources":["/Users/richard/Documents/time-vault/client/src/components/CapsuleOverview.tsx"],"names":["React","useEffect","useState","useSelector","styled","openCapsule","selectAddress","capsuleOpen","capsuleLocked","capsuleReady","Button","getCapsuleUsdValue","Countdown","BlockContent","getCanBeOpened","StyledCapsuleOverview","div","CapsuleImage","img","Usd","ProgressContainer","CapsuleOverview","props","address","usd","setUsd","canBeOpened","capsule","open","id","update","getUsd","_capsule","usdValue","Number","toFixed","toLocaleString","empty","beneficiary"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport styled from \"styled-components\";\n\nimport { openCapsule } from \"../services/contracthelper\";\nimport { selectAddress } from \"../state/userSlice\";\nimport CapsuleType from \"../types/CapsuleType\";\n\nimport capsuleOpen from \"../assets/capsule-open-large.png\";\nimport capsuleLocked from \"../assets/capsule-locked-large.png\";\nimport capsuleReady from \"../assets/capsule-ready-large.png\";\n\nimport Button from \"./Button\";\nimport { getCapsuleUsdValue } from \"../services/oracleService\";\nimport Countdown from \"./Countdown\";\nimport BlockContent from \"./BlockContent\";\nimport { getCanBeOpened } from \"../services/dateHelper\";\n\nconst StyledCapsuleOverview = styled.div`\n  @media (max-width: 600px) {\n    margin-bottom: 6rem;\n  }\n`;\n\nconst CapsuleImage = styled.img`\n  width: 20rem;\n  margin-bottom: 2rem;\n\n  @media (max-width: 600px) {\n    width: 100%;\n  }\n`;\n\nconst Usd = styled.div`\n  font-size: 4rem;\n  margin-bottom: 2rem;\n  transform: rotate(0deg);\n  color: var(--main);\n\n  @media (max-width: 600px) {\n    font-size: 6rem;\n  }\n`;\n\nconst ProgressContainer = styled.div`\n  width: 100%;\n  height: 6rem;\n  background-color: var(--primary);\n`;\n\ntype Props = {\n  capsule: CapsuleType;\n  update: () => void;\n};\n\nconst CapsuleOverview = (props: Props): JSX.Element => {\n  const address = useSelector(selectAddress);\n\n  const [usd, setUsd] = useState<string>(\"\");\n\n  const canBeOpened = getCanBeOpened(props.capsule);\n\n  const open = async () => {\n    await openCapsule(props.capsule.id);\n    props.update();\n  };\n\n  const getUsd = async (_capsule: CapsuleType) => {\n    const usdValue = await getCapsuleUsdValue(_capsule);\n    setUsd(`$${Number(usdValue).toFixed(0).toLocaleString()}`);\n  };\n\n  useEffect(() => {\n    getUsd(props.capsule);\n  }, [props.capsule]);\n\n  return (\n    <StyledCapsuleOverview>\n      <BlockContent\n        content={\n          <>\n            {usd && usd !== \"$0\" && <Usd>{usd}</Usd>}\n            <CapsuleImage\n              src={\n                props.capsule.empty\n                  ? capsuleOpen\n                  : !canBeOpened\n                  ? capsuleLocked\n                  : capsuleReady\n              }\n              alt={\n                props.capsule.empty\n                  ? \"Capsule Empty Image\"\n                  : !canBeOpened\n                  ? \"Capsule Locked Image\"\n                  : \"Capsule Ready Image\"\n              }\n            />\n            <Countdown capsule={props.capsule} />\n            {false && <ProgressContainer>meow</ProgressContainer>}\n            {props.capsule.beneficiary === address &&\n              canBeOpened &&\n              !props.capsule.empty && (\n                <Button primary text=\"Open\" click={() => open()} />\n              )}\n          </>\n        }\n      />\n    </StyledCapsuleOverview>\n  );\n};\n\nexport default CapsuleOverview;\n"]},"metadata":{},"sourceType":"module"}